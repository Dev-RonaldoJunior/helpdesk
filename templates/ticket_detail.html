{% extends "base.html" %}
{% block title %}Detalhes do Chamado{% endblock %}

{% block content %}
<h1>ğŸ“„ Chamado #{{ ticket.id }} - {{ ticket.titulo }}</h1>

<div class="chat-box">
    <p><strong>Status:</strong> {{ ticket.status }}</p>
    <p><strong>Criado em:</strong> {{ ticket.created_at }}</p>
    <p><strong>Criador:</strong> {{ ticket.creator_username }}</p>
    <p><strong>Atendente:</strong> {{ ticket.attendant_username or "â€”" }}</p>

    {% if ticket.is_hidden == 1 %}
        <p><strong>âš« Ocultado:</strong> Sim</p>
        <p><strong>Ocultado por:</strong> {{ ticket.hider_username or "â€”" }}</p>
        <p><strong>Ocultado em:</strong> {{ ticket.hidden_at or "â€”" }}</p>
    {% endif %}

    <hr>

    <h3>ğŸ“ DescriÃ§Ã£o</h3>
    <p>{{ ticket.descricao }}</p>

    <hr>

    <h3>ğŸ’¬ HistÃ³rico de atendimento</h3>

    {% if comments %}
        {% for c in comments %}
            <div class="chat-message">
                <div class="chat-author">{{ c.author }}</div>
                <div class="chat-text">{{ c.comment }}</div>
                <div class="chat-date">{{ c.created_at }}</div>
            </div>
        {% endfor %}
    {% else %}
        <p class="vazio">Nenhuma mensagem ainda.</p>
    {% endif %}

    <hr>

    <h3>âœï¸ Enviar mensagem</h3>
    <form action="{{ url_for('add_comment', ticket_id=ticket.id) }}" method="post">
        <textarea name="comment" placeholder="Digite sua mensagem..." required></textarea>
        <button type="submit">Enviar</button>
    </form>
</div>

<br>
<div style="text-align:center;">
    <a href="{{ url_for('dashboard') }}">â¬… Voltar</a>
</div>

{% endblock %}
